#Trimmea sequences using primers. Not automated, done manually with each sequence 
#Trimmea la vegion variable V4 del gen 16S. Esa region en la que se usa como referencia para los an√°lisis de metabarcoding 
#las secuencias ya trimmeadas se pegan en un .txt que se sube al cluster y sirve como referencia en qiime

library(Biostrings)


sequence<-"GCAGTCGAGCGGATCTCTTCGGAGGTCAGCGGCGGACGGGTGAGTAACACGTGGGCAACCTGCCTGTAAGACTGGGATAACTCCGGGAAACCGGAGCTAATACCGGATATTATTTCAAACCGCATGGTTTGACATTCAAAGACGGTTTCGGCTGTCACTTACAGATGGGCCCGCGGCGCATTAGCTAGTTGGTGAGGTAATGGCTCACCAAGGCAACGATGCGTAGCCGACCTGAGAGGGTGATCGGCCACACTGGGACTGAGACACGGCCCAGACTCCTACGGGAGGCAGCAGTAGGGAATCTTCCGCAATGGACGAAAGTCTGACGGAGCAACGCCGCGTGAGTGATGAAGGTTTTCGGATCGTAAAACTCTGTTGTCAGGGAAGAACAAGTGCCGGAGTAACTGCCGGCGCCTTGACGGTACCTGACCAGAAAGCCACGGCTAACTACGTGCCAGCAGCCGCGGTAATACGTAGGTGGCAAGCGTTGTCCGGAATTATTGGGCGTAAAGCGCGCGCAGGCGGTTTCTTAAGTCTGATGTGAAAGCCCCCGGCTCAACCGGGGAGGGTCATTGGAAACTGGGAAACTTGAGTGCAGAAGAGGAGAGTGGAATTCCACGTGTAGCGGTGAAATGCGTAGAGATGTGGAGGAACACCAGTGGCGAAGGCGACTCTCTGGTCTGTAACTGACGCTGAGGCGCGAAAGCGTGGGGAGCGAACAGGATTAGATACCCTGGTAGTCCACGCCGTAAACGATGAGTGCTAAGTGTTAGAGGGTTTCCGCCCTTTAGTGCTGCAGCTAACGCATTAAGCACTCCGCCTGGGGAGTACGGTCGCAAGACTGAAACTCAAAGGAATTGACGGGGGCCCGCACAAGCGGTGGAGCATGTGGTTTAATTCGAAGCAACGCGAAGAACCTTACCAGGTCTTGACATCCTTTGCCACTTCTAGAGATAGAAGGTTCCCCTTCGGGGGACAAAGTGACAGGTGGTGCATGGTTGTCGTCAGCTCGTGTCGTGAGATGTTGGGTTAAGTCCCGCAACGAGCGCAACCCTTGATCTTAGTTGCCAGCATTCAGTTGGGCACTCTAAGGTGACTGCCGGTGACAAACCGGAGGAAGGTGGGGATGACGTCAAATCATCATGCCCCTTATGACCTGGGCTACACACGTGCTACAATGGATGGTACAAAGGGCTGCGAGACCGCGAGGTTTAGCCAATCCCATAAAACCATTCTCAGTTCGGATTGCAGGCTGCAACTCGCCTGCATGAAGCTGGAATCGCTAGTAATCGCGGATCAGCATGCCGCGGTGAATACGTTCCCGGGCCTTGTACACACCGCCCGTCACACCACGAGAGTTGCAACACCCGAAGTCGGTGGGGTAACCGCAAGGAGCCAGC"
primer_forward<- "CCTACGGGAGGCAGCAG" #515R primer that targets V4 region
primer_reverse<- "ATTAGATACCCTGGTAGTCC" #806r primer that targets v4 region GGACTACNVGGGTWTCTAAT

#position of the forward and reverse primers in the sequence
fwd_pos <- matchPattern(primer_forward, sequence)  
rev_pos <- matchPattern(primer_reverse, sequence)  

#extracts the portion of the sequence with primers included
#trimmed_sequence <- subseq(sequence, start=start(fwd_pos), end=end(rev_pos))

#extracts the portion of the sequence without primers 
trimmed_sequence <- subseq(sequence, start=end(fwd_pos+1), end=start(rev_pos+1))
trimmed_sequence

