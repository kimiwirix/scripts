prv_cut = 0,
s0_perc = 0.05)
m2$res$`q_(Intercept)`
m2$res$q_temp32
m2$res$q_hrs
m2$res$q_hrs_2
m2$res
library ("sangeranalyseR")
dir.create("~/LIIGH/data/data_comsint_4c/sangercontig_fasta_files_2/")
dir.create("~/LIIGH/data/data_comsint_4c/sangercontig_fasta_files/report_abi_sangercontig_alignments_2/")
REGEX_SuffixForward <- "_27F_NS_Premix.ab1"
REGEX_SuffixReverse <- "_1492R_NS_Premix.ab1"
contigname <- c('CH154a', "CH448b", "CH90")
for (name in contigname){
sanger_contig<-SangerContig(
ABIF_Directory = "C:/Users/natal/Documents/LIIGH/data/data_comsint_4c/HC01249078/", #descargar abi files de dropbox a carpeta para ABIF_Directory
inputSource="ABIF",
contigName = name,
REGEX_SuffixForward = REGEX_SuffixForward,
REGEX_SuffixReverse = REGEX_SuffixReverse
)
generateReportSC(sanger_contig,
outputDir = "~/LIIGH/data/data_comsint_4c/sangercontig_fasta_files_2/report_abi_sangercontig_alignments_2/")
#three fasta files: contig(27F y 1429R unidos), alignment y unalignment
fasta<-writeFastaSC(sanger_contig, outputDir = "~/LIIGH/data/data_comsint_4c/sangercontig_fasta_files_2/")
}
sequence<-"GCAGTCGAGCGGACAGATGGGAGCTTGCTCCCTGATGTTAGCGGCGGACGGGTGAGTAACACGTGGGTAACCTGCCTGTAAGACTGGGATAACTCCGGGAAACCGGGGCTAATACCGGATACTTGTTTGAACCGCATGGTTCAAACATAAAAGGTGGCTTCGGCTACCACTTACAGATGGACCCGCGGCGCATTAGCTAGTTGGTGAGGTAATGGCTCACCAAGGCAACGATGCGTAGCCGACCTGAGAGGGTGATCGGCCACACTGGGACTGAGACACGGCCCAGACTCCTACGGGAGGCAGCAGTAGGGAATCTTCCGCAATGGACGAAAGTCTGACGGAGCAACGCCGCGTGAGTGATGAAGGTTTTCGGATCGTAAAGCTCTGTTGTTAGGGAAGAACAAGTGCCGTTCAAATAGGGCGGCACCTTGACGGTACCTAACCAGAAAGCCACGGCTAACTACGTGCCAGCAGCCGCGGTAATACGTAGGTGGCAAGCGTTGTCCGGAATTATTGGGCGTAAAGGGCTCGCAGGCGGTTTCTTAAGTCTGATGTGAAAGCCCCCGGCTCAACCGGGGAGGGTCATTGGAAACTGGGGAACTTGAGTGCAGAAGAGGAGAGTGGAATTCCACGTGTAGCGGTGAAATGCGTAGAGATGTGGAGGAACACCAGTGGCGAAGGCGACTCTCTGGTCTGTAACTGACGCTGAGGAGCGAAAGCGTGGGGAGCGAACAGGATTAGATACCCTGGTAGTCCACGCCGTAAACGATGAGTGCTAAGTGTTAGGGGGTTTCCGCCCCTTAGTGCTGCAGCTAACGCATTAAGCACTCCGCCTGGGGAGTACGGTCGCAAGACTGAAACTCAAAGGAATTGACGGGGGCCCGCACAAGCGGTGGAGCATGTGGTTTAATTCGAAGCAACGCGAAGAACCTTACCAGGTCTTGACATCCTCTGACACCCCTAGAGATAGGGCTTCCCCTTCGGGGGCAGAGTGACAGGTGGTGCATGGTTGTCGTCAGCTCGTGTCGTGAGATGTTGGGTTAAGTCCCGCAACGAGCGCAACCCTTGATCTTAGTTGCCAGCATTCAGTTGGGCACTCTAAGGTGACTGCCGGTGACAAACCGGAGGAAGGTGGGGATGACGTCAAATCATCATGCCCCTTATGACCTGGGCTACACACGTGCTACAATGGACAGAACAAAGGGCAGCGAGACCGCGAGGTTAAGCCAATCCCACAAATCTGTTCTCAGTTCGGATCGCAGTCTGCAACTCGACTGCGTGAAGCTGGAATCGCTAGTAATCGCGGATCAGCATGCCGCGGTGAATACGTTCCCGGGCCTTGTACACACCGCCCGTCACACCACGAGAGTTTGTAACACCCGAAGTCGGTGAGGTAACCTTTATGGAGCCA"
primer_forward<- "CCTACGGGAGGCAGCAG" #V4 region
primer_reverse<- "ATTAGATACCCTGGTAGTCC" #v4 region, not primer
#position of the forward and reverse primers in the sequence
fwd_pos <- matchPattern(primer_forward, sequence)
rev_pos <- matchPattern(primer_reverse, sequence)
#extracts the portion of the sequence without primers
trimmed_sequence <- subseq(sequence, start=end(fwd_pos+1), end=start(rev_pos+1))
trimmed_sequence
sequence<-"GTCGACGGTGAAGCAGGAGCTTGCTCTTGTGGATCAGTGGCGAACGGGTGAGTAACACGTGAGCAACCTGCCCCTGACTCTGGGATAAGCGCTGGAAACGGCGTCTAATACTGGATATGTGACGTGACCGCATGGTCTGCGTTTGGAAAGATTTTTCGGTTGGGGATGGGCTCGCGGCCTATCAGCTTGTTGGTGAGGTAATGGCTCACCAAGGCGTCGACGGGTAGCCGGCCTGAGAGGGTGACCGGCCACACTGGGACTGAGACACGGCCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGAAAGCCTGATGCAGCAACGCCGCGTGAGGGATGACGGCCTTCGGGTTGTAAACCTCTTTTAGCAGGGAAGAAGCGAAAGTGACGGTACCTGCAGAAAAAGCGCCGGCTAACTACGTGCCAGCAGCCGCGGTAATACGTAGGGCGCAAGCGTTATCCGGAATTATTGGGCGTAAAGAGCTCGTAGGCGGTTTGTCGCGTCTGCTGTGAAATCCCGAGGCTCAACCTCGGGCCTGCAGTGGGTACGGGCAGACTAGAGTGCGGTAGGGGAGATTGGAATTCCTGGTGTAGCGGTGGAATGCGCAGATATCAGGAGGAACACCGATGGCGAAGGCAGATCTCTGGGCCGTAACTGACGCTGAGGAGCGAAAGGGTGGGGAGCAAACAGGCTTAGATACCCTGGTAGTCCACCCCGTAAACGTTGGGAACTAGTTGTGGGGTCCATTCCACGGATTCCGTGACGCAGCTAACGCATTAAGTTCCCCGCCTGGGGAGTACGGCCGCAAGGCTAAAACTCAAAGGAATTGACGGGGACCCGCACAAGCGGCGGAGCATGCGGATTAATTCGATGCAACGCGAAGAACCTTACCAAGGCTTGACATATACGAGAACGGGCCAGAAATGGTCAACTCTTTGGACACTCGTAAACAGGTGGTGCATGGTTGTCGTCAGCTCGTGTCGTGAGATGTTGGGTTAAGTCCCGCAACGAGCGCAACCCTCGTTCTATGTTGCCAGCACGTAATGGTGGGAACTCATGGGATACTGCCGGGGTCAACTCGGAGGAAGGTGGGGATGACGTCAAATCATCATGCCCCTTATGTCTTGGGCTTCACGCATGCTACAATGGCCGGTACAAAGGGCTGCAATACCGTGAGGTGGAGCGAATCCCAAAAAGCCGGTCCCAGTTCGGATTGAGGTCTGCAACTCGACCTCATGAAGTCGGAGTCGCTAGTAATCGCAGATCAGCAACGCTGCGGTGAATACGTTCCCGGGTCTTGTACACACCGCCCGTCAAGTCATGAAAGTCGGTAACACCTGAAGCCGGTGGCCTAACCCTGTGGAGGAG"
primer_forward<- "CCTACGGGAGGCAGCAG" #V4 region
primer_reverse<- "ATTAGATACCCTGGTAGTCC" #v4 region, not primer
#position of the forward and reverse primers in the sequence
fwd_pos <- matchPattern(primer_forward, sequence)
rev_pos <- matchPattern(primer_reverse, sequence)
#extracts the portion of the sequence without primers
trimmed_sequence <- subseq(sequence, start=end(fwd_pos+1), end=start(rev_pos+1))
sequence<-"CAGTCGAGCGACAGATAGGAGCTTGCTCCTTTGACGTTAGCGGCGGACGGGTGAGTAACACGTGGGTAACCTACCTATAAGACTGGGATAACTTCGGGAAACCGGAGCTAATACCGGATAACATTTGGAACCGCAGGTTCTAAAGTGAAAGATGGTTTTGCTATCACTTATAGATGGACCCGCGCCGTATTAGCTAGTTGGTAAGGTAACGGCTTACCAAGGCAACGATACGTAGCCGACCTGAGAGGGTGATCGGCCACACTGGAACTGAGACACGGTCCAGACTCCTACGGGAGGCAGCAGTAGGGAATCTTCCGCAATGGGCGAAAGCCTGACGGAGCAACGCCGCGTGAGTGATGAAGGGTTTCGGCTCGTAAAACTCTGTTATTAGGGAAGAACAAATGTGTAAGTAACTGTGCACATCTTGACGGTACCTAATCAGAAAGCCACGGCTAACTACGTGCCAGCAGCCGCGGTAATACGTAGGTGGCAAGCGTTATCCGGAATTATTGGGCGTAAAGCGCGCGTAGGCGGTTTCTTAAGTCTGATGTGAAAGCCCACGGCTCAACCGTGGAGGGTCATTGGAAACTGGGAAACTTGAGTGCAGAAGAGGAAAGTGGAATTCCATGTGTAGCGGTGAAATGCGCAGAGATATGGAGGAACACCAGTGGCGAAGGCGACTTTCTGGTCTGTAACTGACGCTGATGTGCGAAAGCGTGGGGATCAAACAGGATTAGATACCCTGGTAGTCCACGCCGTAAACGATGAGTGCTAAGTGTTAGGGGGTTTCCGCCCCTTAGTGCTGCAGCTAACGCATTAAGCACTCCGCCTGGGGAGTACGACCGCAAGGTTGAAACTCAAAGGAATTGACGGGGACCCGCACAAGCGGTGGAGCATGTGGTTTAATTCGAAGCAACGCGAAGAACCTTACCAAATCTTGACATCCTTTGAAAACTCTAGAGATAGAGCCTTCCCCTTCGGGGGACAAAGTGACAGGTGGTGCATGGTTGTCGTCAGCTCGTGTCGTGAGATGTTGGGTTAAGTCCCGCAACGAGCGCAACCCTTAAGCTTAGTTGCCATCATTAAGTTGGGCACTCTAGGTTGACTGCCGGTGACAAACCGGAGGAAGGTGGGGATGACGTCAAATCATCATGCCCCTTATGATTTGGGCTACACACGTGCTACAATGGACAATACAAAGGGCAGCTAAACCGCGAGGTCATGCAAATCCCATAAAGTTGTTCTCAGTTCGGATTGTAGTCTGCAACTCGACTACATGAAGCTGGAATCGCTAGTAATCGTAGATCAGCATGCTACGGTGAATACGTTCCCGGGTCTTGTACACACCGCCCGTCACACCACGAGAGTTTGTAACACCCGAAGCCGGTGGAGTAACCATTTATGGAGCTAG"
primer_forward<- "CCTACGGGAGGCAGCAG" #V4 region
primer_reverse<- "ATTAGATACCCTGGTAGTCC" #v4 region, not primer
#position of the forward and reverse primers in the sequence
fwd_pos <- matchPattern(primer_forward, sequence)
rev_pos <- matchPattern(primer_reverse, sequence)
#extracts the portion of the sequence without primers
trimmed_sequence <- subseq(sequence, start=end(fwd_pos+1), end=start(rev_pos+1))
trimmed_sequence
REGEX_SuffixForward <- "_27F_NS_Premix.ab1"
REGEX_SuffixReverse <- "_1492R_NS_Premix.ab1"
contigname <- c('CH149a', "CH447")
sanger_contig<-SangerContig(
ABIF_Directory = "C:/Users/natal/Documents/LIIGH/data/data_comsint_4c/HC0UNIDOS//", #descargar abi files de dropbox a carpeta para ABIF_Directory
inputSource="ABIF",
contigName = name,
REGEX_SuffixForward = REGEX_SuffixForward,
REGEX_SuffixReverse = REGEX_SuffixReverse
)
for (name in contigname){
sanger_contig<-SangerContig(
ABIF_Directory = "C:/Users/natal/Documents/LIIGH/data/data_comsint_4c/HC0UNIDOS", #descargar abi files de dropbox a carpeta para ABIF_Directory
inputSource="ABIF",
contigName = name,
REGEX_SuffixForward = REGEX_SuffixForward,
REGEX_SuffixReverse = REGEX_SuffixReverse
)
generateReportSC(sanger_contig,
outputDir = "~/LIIGH/data/data_comsint_4c/sangercontig_fasta_files_2/report_abi_sangercontig_alignments_2/")
#three fasta files: contig(27F y 1429R unidos), alignment y unalignment
fasta<-writeFastaSC(sanger_contig, outputDir = "~/LIIGH/data/data_comsint_4c/sangercontig_fasta_files_2/")
}
sequence<-"TCGAACGATGAAGCCCAGCTTGCTGGGTGGATTAGTGGCGAACGGGTGAGTAACACGTGAGTAACCTGCCCTTAACTCTGGGATAAGCCTGGGAAACTGGGTCTAATACCGGATAGGAGCGTCCACCGCATGGTGGGTGTTGGAAAGATTTATCGGTTTTGGATGGACTCGCGGCCTATCAGCTTGTTGGTGAGGTAATGGCTCACCAAGGCGACGACGGGTAGCCGGCCTGAGAGGGTGACCGGCCACACTGGGACTGAGACACGGCCCAGACTCCTACGGGAGGCAGCAGTGGGGAATATTGCACAATGGGCGCAAGCCTGATGCAGCGACGCCGCGTGAGGGATGACGGCCTTCGGGTTGTAAACCTCTTTCAGTAGGGAAGAAGCGAAAGTGACGGTACCTGCAGAAGAAGCACCGGCTAACTACGTGCCAGCAGCCGCGGTAATACGTAGGGTGCGAGCGTTATCCGGAATTATTGGGCGTAAAGAGCTCGTAGGCGGTTTGTCGCGTCTGTCGTGAAAGTCCGGGGCTTAACCCCGGATCTGCGGTGGGTACGGGCAGACTAGAGTGCAGTAGGGGAGACTGGAATTCCTGGTGTAGCGGTGGAATGCGCAGATATCAGGAGGAACACCGATGGCGAAGGCAGGTCTCTGGGCTGTAACTGACGCTGAGGAGCGAAAGCATGGGGAGCGAACAGGATTAGATACCCTGGTAGTCCATGCCGTAAACGTTGGGCACTAGGTGTGGGGACCATTCCACGGTTTCCGCGCCGCAGCTAACGCATTAAGTGCCCCGCCTGGGGAGTACGGCCGCAAGGCTAAAACTCAAAGGAATTGACGGGGGCCCGCACAAGCGGCGGAGCATGCGGATTAATTCGATGCAACGCGAAGAACCTTACCAAGGCTTGACATGTTCTCGATCGCCGTAGAGATACGGTTTCCCCTTTGGGGCGGGTTCACAGGTGGTGCATGGTTGTCGTCAGCTCGTGTCGTGAGATGTTGGGTTAAGTCCCGCAACGAGCGCAACCCTCGTTCCATGTTGCCAGCACGTAATGGTGGGGACTCATGGGAGACTGCCGGGGTCAACTCGGAGGAAGGTGAGGACGACGTCAAATCATCATGCCCCTTATGTCTTGGGCTTCACGCATGCTACAATGGCCGGTACAATGGGTTGCGATACTGTGAGGTGGAGCTAATCCCAAAAAGCCGGTCTCAGTTCGGATTGGGGTCTGCAACTCGACCCCATGAAGTCGGAGTCGCTAGTAATCGCAGATCAGCAACGCTGCGGTGAATACGTTCCCGGGCCTTGTACACACCGCCCGTCAAGTCACGAAAGTTGGTAACACCCGAAGCCGGTGGCCTAACCCTTGTGGGGGAG"
primer_forward<- "CCTACGGGAGGCAGCAG" #V4 region
primer_reverse<- "ATTAGATACCCTGGTAGTCC" #v4 region, not primer
#position of the forward and reverse primers in the sequence
fwd_pos <- matchPattern(primer_forward, sequence)
rev_pos <- matchPattern(primer_reverse, sequence)
#extracts the portion of the sequence without primers
trimmed_sequence <- subseq(sequence, start=end(fwd_pos+1), end=start(rev_pos+1))
trimmed_sequence
sequence<-"CAAGTCGAGCGAACTGATTAGAAGCTTGCTTCTATGACGTTAGCGGCGGACGGGTGAGTAACACGTGGGCAACCTGCCTGTAAGACTGGGATAACTTCGGGAAACCGAAGCTAATACCGGATAACATCATTCCTTGCATAAGGAATGATTGAAAGATGGTTTCGGCTATCACTTACAGATGGGCCCGCGGTGCATTAGCTAGTTGGTGAGGTAACGGCTCACCAAGGCAACGATGCATAGCCGACCTGAGAGGGTGATCGGCCACACTGGGACTGAGACACGGCCCAGACTCCTACGGGAGGCAGCAGTAGGGAATCTTCCGCAATGGACGAAAGTCTGACGGAGCAACGCCGCGTGAGTGATGAAGGCTTTCGGGTCGTAAAACTCTGTTGTTAGGGAAGAACAAGTATGAGAGTAACTGCTCGTACCTTGACGGTACCTAACCAGAAAGCCACGGCTAACTACGTGCCAGCAGCCGCGGTAATACGTAGGTGGCAAGCGTTATCCGGAATTATTGGGCGTAAAGCGCGCGCAGGCGGTTTCTTAAGTCTGATGTGAAAGCCCACGGCTCAACCGTGGAGGGTCATTGGAAACTGGGGAACTTGAGTGCAGAAGAGAAAAGCGGAATTCCACGTGTAGCGGTGAAATGCGTAGAGATGTGGAGGAACACCAGTGGCGAAGGCGGCTTTTTGGTCTGTAACTGACGCTGAGGCGCGAAAGCGTGGGGAGCAAACAGGATTAGATACCCTGGTAGTCCACGCCGTAAACGATGAGTGCTAAGTGTTAGAGGGTTTCCGCCCTTTAGTGCTGCAGCTAACGCATTAAGCACTCCGCCTGGGGAGTACGGTCGCAAGACTGAAACTCAAAGGAATTGACGGGGGCCCGCACAAGCGGTGGAGCATGTGGTTTAATTCGAAGCAACGCGAAGAACCTTACCAGGTCTTGACATCCTCTGACAACTCTAGAGATAGAGCGTTCCCCTTCGGGGGACAGAGTGACAGGTGGTGCATGGTTGTCGTCAGCTCGTGTCGTGAGATGTTGGGTTAAGTCCCGCAACGAGCGCAACCCTTGATCTTAGTTGCCAGCATTTAGTTGGGCACTCTAAGGTGACTGCCGGTGACAAACCGGAGGAAGGTGGGGATGACGTCAAATCATCATGCCCCTTATGACCTGGGCTACACACGTGCTACAATGGATGGTACAAAGGGCTGCAAGACCGCGAGGTTAAGCCAATCCCATAAAACCATTCTCAGTTCGGATTGTAGGCTGCAACTCGCCTACATGAAGCTGGAATCGCTAGTAATCGCGGATCAGCATGCCGCGGTGAATACGTTCCCGGGCCTTGTACACACCGCCCGTCACACCACGAGAGTTTGTAACACCCGAAGTCGGTGGGGTAACCGTAAGGAGCCAGCCGCCTA"
primer_forward<- "CCTACGGGAGGCAGCAG" #V4 region
primer_reverse<- "ATTAGATACCCTGGTAGTCC" #v4 region, not primer
#position of the forward and reverse primers in the sequence
fwd_pos <- matchPattern(primer_forward, sequence)
rev_pos <- matchPattern(primer_reverse, sequence)
#extracts the portion of the sequence without primers
trimmed_sequence <- subseq(sequence, start=end(fwd_pos+1), end=start(rev_pos+1))
trimmed_sequence
library(readODS)
library(ggplot2)
library(tidyverse)
library(reshape2)
library(tidyverse)
library(ggpubr)
#data 1 y 2 son las réplicas de crecimiento de bact indiviiduales
data_ss_1 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_test_single_strains.ods", sheet = "OD_1") %>%
as.data.frame()%>%
rename("0"="t_0", "4"="t_1", "20"="t_2", "24"="t_3", "48"="t_4", "72"="t_5")%>%
select(-"4",-"20") %>%
filter(!strain %in% c("ST00122","ST00021"))
data_ss_2 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_test_bacteria_comsint.ods", sheet = "OD600")%>%
rename("0"="t_0", "24"="t_1", "48"="t_2", "72"="t_3")%>%
full_join(data_ss_1)%>%
group_by(strain, temp)%>%
summarize(across(c("0","24","48","72"), mean))%>%
as.data.frame()
data_ss<-melt(data = data_ss_2, id.vars = c("strain", "temp"), variable.name = "time", value.name = "od600")
d¿¿head(data_ss)
head(data_ss)
View(data_ss_1)
View(data_ss_2)
View(data_ss)
s
s
###community composition, which strain should be in which community
ns1 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS1.ods", sheet = "syncoms")%>%
as.data.frame()
ns2 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS2.ods", sheet = "syncoms")%>%
as.data.frame()%>%
select(-"strain")
ns<-cbind(ns1,ns2)
View(ns)
(0.5280+0.542)/2
ns<-melt(ns, id.vars = "strain")%>%
filter(!is.na(value))
View(ns)
data_ss<-data_ss%>%
group_by(temp,time,variable)%>%
summarize(mean_value = mean(od600, na.rm = TRUE))%>%
as.data.frame()%>%
rename("Community"="variable", "od600"="mean_value")
data_ss<-data_ss%>%
group_by(temp,time,strain)%>%
summarize(mean_value = mean(od600, na.rm = TRUE))%>%
as.data.frame()%>%
rename("Community"="variable", "od600"="mean_value")
#data 1 y 2 son las réplicas de crecimiento de bact indiviiduales
data_ss_1 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_test_single_strains.ods", sheet = "OD_1") %>%
as.data.frame()%>%
rename("0"="t_0", "4"="t_1", "20"="t_2", "24"="t_3", "48"="t_4", "72"="t_5")
View(data_ss_1)
View(data_ss)
ns<-cbind(ns1,ns2)
ns<-melt(ns, id.vars = "strain")%>%
filter(!is.na(value))
data_ss<-merge(data_ss,ns, by = "strain")
View(data_ss)
data_ss<-data_ss%>%
group_by(temp,time,variable)%>%
summarize(mean_value = mean(od600, na.rm = TRUE))%>%
as.data.frame()%>%
rename("Community"="variable", "od600"="mean_value")
#data ods per comsint
data_comsint_1 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS1.ods", sheet = "OD600_real") %>%
mutate(exp="NS1")%>%
as.data.frame()
data_comsint_2 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS2.ods", sheet = "OD600_real") %>%
mutate(exp="NS2")%>%
as.data.frame()
data_comsint_3 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS3.ods", sheet = "OD600_real") %>%
mutate(exp="NS3")%>%
as.data.frame()
data_comsint_4 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS4.ods", sheet = "OD600_real") %>%
mutate(exp="NS4")%>%
as.data.frame()
View(data_comsint_4)
data_comsints<-rbind(data_comsint_1,data_comsint_2,data_comsint_3,data_comsint_4)
colnames(data_comsints)<-c("Community","temp", "0","24","48","72", "exp")
data_comsints<-melt(data_comsints, id.vars=c("Community","exp","temp"),
variable.name = "time", value.name = "od600")
#PLOT
communities<-c("R1","R2","R3","R4","R5","R6","R7","R8","R9","R10","R11","R12")
colors<-c("28"="#63B8FF", "32"="lightsalmon")
data_comsints$Community <- factor(data_comsints$Community, levels = communities) # Custom order
data_ss$Community <- factor(data_ss$Community, levels = communities) # Custom order
plot<-ggplot(NULL, aes(x = time, y = od600))+
geom_line(data=data_comsints, aes(group = interaction(temp, exp), colour = as.factor(temp), linetype="Synthetic communities"))+
geom_line(data=data_ss, aes(group = temp, colour = as.factor(temp), linetype = "Single strains"))+
facet_wrap(~Community)+
scale_color_manual(values =colors)+
scale_linetype_manual(values = c("Synthetic communities" = "solid", "Single strains" = "dashed")) +
labs(title = "Growth: Individual vs Communities  ", y = "OD600", x = "Time (hrs)", color="Temperature (°C)", linetype="Growth")+
theme(plot.title = element_text(hjust = 0.5))
plot
#data 1 y 2 son las réplicas de crecimiento de bact indiviiduales
data_ss_1 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_test_single_strains.ods", sheet = "OD_1") %>%
as.data.frame()%>%
rename("0"="t_0", "4"="t_1", "20"="t_2", "24"="t_3", "48"="t_4", "72"="t_5")%>%
select(-"4",-"20") %>%
filter(!strain %in% c("ST00122","ST00021"))
#data 1 y 2 son las réplicas de crecimiento de bact indiviiduales
data_ss_1 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_test_single_strains.ods", sheet = "OD_1") %>%
as.data.frame()%>%
rename("0"="t_0", "4"="t_1", "20"="t_2", "24"="t_3", "48"="t_4", "72"="t_5")%>%
select(-"4",-"20") %>%
filter(!strain %in% c("ST00122","ST00021"))
View(data_ss_1)
#data 1 y 2 son las réplicas de crecimiento de bact indiviiduales
data_ss_1 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_test_single_strains.ods", sheet = "OD_1") %>%
as.data.frame()%>%
rename("0"="t_0", "4"="t_1", "20"="t_2", "24"="t_3", "48"="t_4", "72"="t_5")%>%
select(-"4",-"20") %>%
filter(!strain %in% c("ST00122","ST00021"))
data_ss_2 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_test_bacteria_comsint.ods", sheet = "OD600")%>%
rename("0"="t_0", "24"="t_1", "48"="t_2", "72"="t_3")%>%
full_join(data_ss_1)%>%
group_by(strain, temp)%>%
summarize(across(c("0","24","48","72"), mean))%>%
as.data.frame()
data_ss<-melt(data = data_ss_2, id.vars = c("strain", "temp"), variable.name = "time", value.name = "od600")#melted mean of ss_2 and ss_1
View(data_ss)
kk<-data_ss%>%
mutate(od600="od600"*0.20)
kk<-data_ss%>%
mutate(od600=data_ss$od600*0.20)
View(kk)
0.11693333/.2
0.11693333*5
###community composition, which strain should be in which community
ns1 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS1.ods", sheet = "syncoms")%>%
as.data.frame()
ns2 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS2.ods", sheet = "syncoms")%>%
as.data.frame()%>%
select(-"strain")
ns<-cbind(ns1,ns2)
ns<-melt(ns, id.vars = "strain")%>%
filter(!is.na(value))
data_ss<-merge(data_ss,ns, by = "strain")
kk_ss<-merge(kk,ns, by = "strain")
kk_ss<-merge(kk,ns, by = "strain")
View(kk_ss)
###community composition, which strain should be in which community
ns1 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS1.ods", sheet = "syncoms")%>%
as.data.frame()
ns2 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS2.ods", sheet = "syncoms")%>%
as.data.frame()%>%
select(-"strain")
ns<-cbind(ns1,ns2)
ns<-melt(ns, id.vars = "strain")%>%
filter(!is.na(value))
kk_ss<-merge(kk,ns, by = "strain")
#data 1 y 2 son las réplicas de crecimiento de bact indiviiduales
data_ss_1 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_test_single_strains.ods", sheet = "OD_1") %>%
as.data.frame()%>%
rename("0"="t_0", "4"="t_1", "20"="t_2", "24"="t_3", "48"="t_4", "72"="t_5")%>%
select(-"4",-"20") %>%
filter(!strain %in% c("ST00122","ST00021"))
data_ss_2 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_test_bacteria_comsint.ods", sheet = "OD600")%>%
rename("0"="t_0", "24"="t_1", "48"="t_2", "72"="t_3")%>%
full_join(data_ss_1)%>%
group_by(strain, temp)%>%
summarize(across(c("0","24","48","72"), mean))%>%
as.data.frame()
data_ss<-melt(data = data_ss_2, id.vars = c("strain", "temp"), variable.name = "time", value.name = "od600")#melted mean of ss_2 and ss_1
###community composition, which strain should be in which community
ns1 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS1.ods", sheet = "syncoms")%>%
as.data.frame()
ns2 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS2.ods", sheet = "syncoms")%>%
as.data.frame()%>%
select(-"strain")
ns<-cbind(ns1,ns2)
ns<-melt(ns, id.vars = "strain")%>%
filter(!is.na(value))
data_ss<-merge(data_ss,ns, by = "strain")
ns<-cbind(ns1,ns2)
View(ns)
kk<-data_ss%>%
mutate(od600=data_ss$od600*0.20)
data_ss<-melt(data = data_ss_2, id.vars = c("strain", "temp"), variable.name = "time", value.name = "od600")#melted mean of ss_2 and ss_1
kk<-data_ss%>%
mutate(od600=data_ss$od600*0.20)
###community composition, which strain should be in which community
ns1 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS1.ods", sheet = "syncoms")%>%
as.data.frame()
ns2 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS2.ods", sheet = "syncoms")%>%
as.data.frame()%>%
select(-"strain")
ns<-cbind(ns1,ns2)
ns<-melt(ns, id.vars = "strain")%>%
filter(!is.na(value))
kk_ss<-merge(kk,ns, by = "strain")
kk_ss<-kk_ss%>%
group_by(temp,time,variable)%>%
summarize(mean_value = mean(od600, na.rm = TRUE))%>%
as.data.frame()%>%
rename("Community"="variable", "od600"="mean_value")
kk_ss<-merge(kk,ns, by = "strain")
View(kk)
kk_ss<-kk_ss%>%
group_by(temp,time,variable)%>%
summarize(sum_value = sum(od600, na.rm = TRUE))%>%
as.data.frame()%>%
rename("Community"="variable", "od600"="mean_value")
ns<-cbind(ns1,ns2)
ns<-melt(ns, id.vars = "strain")%>%
filter(!is.na(value))
kk_ss<-merge(kk,ns, by = "strain")
kk_ss<-kk_ss%>%
group_by(temp,time,variable)%>%
summarize(sum_value = sum(od600, na.rm = TRUE))%>%
as.data.frame()%>%
rename("Community"="variable", "od600"="mean_value")
kk_ss<-kk_ss%>%
group_by(temp,time,variable)%>%
summarize(sum_value = sum(od600, na.rm = TRUE))%>%
as.data.frame()%>%
rename("Community"="variable", "od600"="sum_value")
#data ods per comsint
data_comsint_1 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS1.ods", sheet = "OD600_real") %>%
mutate(exp="NS1")%>%
as.data.frame()
data_comsint_2 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS2.ods", sheet = "OD600_real") %>%
mutate(exp="NS2")%>%
as.data.frame()
data_comsint_3 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS3.ods", sheet = "OD600_real") %>%
mutate(exp="NS3")%>%
as.data.frame()
data_comsint_4 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS4.ods", sheet = "OD600_real") %>%
mutate(exp="NS4")%>%
as.data.frame()
data_comsints<-rbind(data_comsint_1,data_comsint_2,data_comsint_3,data_comsint_4)
colnames(data_comsints)<-c("Community","temp", "0","24","48","72", "exp")
data_comsints<-melt(data_comsints, id.vars=c("Community","exp","temp"),
variable.name = "time", value.name = "od600")
#PLOT
communities<-c("R1","R2","R3","R4","R5","R6","R7","R8","R9","R10","R11","R12")
colors<-c("28"="#63B8FF", "32"="lightsalmon")
data_comsints$Community <- factor(data_comsints$Community, levels = communities) # Custom order
kk_ss$Community <- factor(data_ss$Community, levels = communities) # Custom order
kk_ss$Community <- factor(kk_ss$Community, levels = communities) # Custom order
plot<-ggplot(NULL, aes(x = time, y = od600))+
geom_line(data=data_comsints, aes(group = interaction(temp, exp), colour = as.factor(temp), linetype="Synthetic communities"))+
geom_line(data=data_ss, aes(group = temp, colour = as.factor(temp), linetype = "Single strains"))+
facet_wrap(~Community)+
scale_color_manual(values =colors)+
scale_linetype_manual(values = c("Synthetic communities" = "solid", "Single strains" = "dashed")) +
labs(title = "Growth: Individual vs Communities  ", y = "OD600", x = "Time (hrs)", color="Temperature (°C)", linetype="Growth")+
theme(plot.title = element_text(hjust = 0.5))
plot
library(readODS)
library(ggplot2)
library(tidyverse)
library(reshape2)
library(tidyverse)
library(ggpubr)
#data 1 y 2 son las réplicas de crecimiento de bact indiviiduales
data_ss_1 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_test_single_strains.ods", sheet = "OD_1") %>%
as.data.frame()%>%
rename("0"="t_0", "4"="t_1", "20"="t_2", "24"="t_3", "48"="t_4", "72"="t_5")%>%
select(-"4",-"20") %>%
filter(!strain %in% c("ST00122","ST00021"))
View(data_ss_1)
data_ss_2 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_test_bacteria_comsint.ods", sheet = "OD600")%>%
rename("0"="t_0", "24"="t_1", "48"="t_2", "72"="t_3")%>%
full_join(data_ss_1)
View(data_ss_2)
data_ss_2 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_test_bacteria_comsint.ods", sheet = "OD600")%>%
rename("0"="t_0", "24"="t_1", "48"="t_2", "72"="t_3")%>%
full_join(data_ss_1)%>%
group_by(strain, temp)%>%
summarize(across(c("0","24","48","72"), mean))
View(data_ss_2)
data_ss<-melt(data = data_ss_2, id.vars = c("strain", "temp"), variable.name = "time", value.name = "od600")#melted mean of ss_2 and ss_1
data_ss_fifth<-data_ss%>%
mutate(od600=data_ss$od600*0.20)
View(data_ss_fifth)
###community composition, which strain should be in which community
ns1 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS1.ods", sheet = "syncoms")%>%
as.data.frame()
ns2 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS2.ods", sheet = "syncoms")%>%
as.data.frame()%>%
select(-"strain")
ns<-cbind(ns1,ns2)
ns<-melt(ns, id.vars = "strain")%>%
filter(!is.na(value))
View(ns)
fifth_merged<-merge(data_ss_fifth,ns, by = "strain")
View(fifth_merged)
fifth_df<-fifth_merged%>%
group_by(temp,time,variable)
fifth_df<-fifth_merged%>%
group_by(temp,time,variable)%>%
summarize(sum_value = sum(od600, na.rm = TRUE))%>%
as.data.frame()%>%
rename("Community"="variable", "od600"="sum_value")
View(fifth_df)
0.09250000+0.03570000+0.08020000+0.02010000+0.07170000
#data ods per comsint
data_comsint_1 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS1.ods", sheet = "OD600_real") %>%
mutate(exp="NS1")%>%
as.data.frame()
data_comsint_2 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS2.ods", sheet = "OD600_real") %>%
mutate(exp="NS2")%>%
as.data.frame()
data_comsint_3 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS3.ods", sheet = "OD600_real") %>%
mutate(exp="NS3")%>%
as.data.frame()
data_comsint_4 <- read_ods("C:/Users/natal/Documents/LIIGH/data/data_comsint_rhizos/data_NS4.ods", sheet = "OD600_real") %>%
mutate(exp="NS4")%>%
as.data.frame()
data_comsints<-rbind(data_comsint_1,data_comsint_2,data_comsint_3,data_comsint_4)
colnames(data_comsints)<-c("Community","temp", "0","24","48","72", "exp")
data_comsints<-melt(data_comsints, id.vars=c("Community","exp","temp"),
variable.name = "time", value.name = "od600")
#PLOT
communities<-c("R1","R2","R3","R4","R5","R6","R7","R8","R9","R10","R11","R12")
colors<-c("28"="#63B8FF", "32"="lightsalmon")
data_comsints$Community <- factor(data_comsints$Community, levels = communities) # Custom order
fifth_df$Community <- factor(fifth_df$Community, levels = communities) # Custom order
plot<-ggplot(NULL, aes(x = time, y = od600))+
geom_line(data=data_comsints, aes(group = interaction(temp, exp), colour = as.factor(temp), linetype="Synthetic communities"))+
geom_line(data=fifth_df, aes(group = temp, colour = as.factor(temp), linetype = "Single strains"))+
facet_wrap(~Community)+
scale_color_manual(values =colors)+
scale_linetype_manual(values = c("Synthetic communities" = "solid", "Single strains" = "dashed")) +
labs(title = "Growth: Individual vs Communities  ", y = "OD600", x = "Time (hrs)", color="Temperature (°C)", linetype="Growth")+
theme(plot.title = element_text(hjust = 0.5))
plot
library(readODS)
library(dplyr)
library(ggplot2)
file<-"C:/Users/natal/Documents/LIIGH/data/data_comsint_4c/individual_strains_growth_curves.ods"
sheets<-ods_sheets("C:/Users/natal/Documents/LIIGH/data/data_comsint_4c/individual_strains_growth_curves.ods")
sheets<-ods_sheets("C:/Users/natal/Documents/LIIGH/data/data_comsint_4c/individual_strains_growth_curves_NEW.ods")
ch<-sheets[grepl("^CH", sheets)]
t<-lapply(ch, function(ch_sheet){ #all sheets that start with CH in one tibble
read_ods(file, sheet = ch_sheet)
})%>%
bind_rows()%>%
filter(!is.na(`OD real`)) %>% #filters rows I put as separation between temps in ods
filter(!`OD real`>0.5)
file<-"C:/Users/natal/Documents/LIIGH/data/data_comsint_4c/individual_strains_growth_curves_NEW.ods"
sheets<-ods_sheets("C:/Users/natal/Documents/LIIGH/data/data_comsint_4c/individual_strains_growth_curves_NEW.ods")
ch<-sheets[grepl("^CH", sheets)]
t<-lapply(ch, function(ch_sheet){ #all sheets that start with CH in one tibble
read_ods(file, sheet = ch_sheet)
})%>%
bind_rows()%>%
filter(!is.na(`OD real`)) %>% #filters rows I put as separation between temps in ods
filter(!`OD real`>0.5)
t<-lapply(ch, function(ch_sheet){ #all sheets that start with CH in one tibble
read_ods(file, sheet = ch_sheet)
})%>%
bind_rows()%>%
filter(!is.na(`OD real`)) #filters rows I put as separation between temps in ods
head(t)
View(t)
10*3*10
10*3*2*10
10*3*3*10
t<-lapply(ch, function(ch_sheet){ #all sheets that start with CH in one tibble
read_ods(file, sheet = ch_sheet)
})%>%
bind_rows()%>%
filter(!is.na(`OD real`)) %>% #filters rows I put as separation between temps in ods
filter(!is.na(`fecha`))
t<-lapply(ch, function(ch_sheet){ #all sheets that start with CH in one tibble
read_ods(file, sheet = ch_sheet)
})%>%
bind_rows()%>%
filter(!is.na(`OD real`)) %>% #filters rows I put as separation between temps in ods
filter(!is.na(`fecha`))
head(t)
#wrapped por temp
g1<-ggplot(data = t, aes(x = hr, y = `OD real`, colour = Cepa, linetype = as.factor(rep)))+
geom_line()+
facet_wrap(~temp)+
scale_x_continuous(limits = c(0,18))+
labs( title = "Growth curve",y=expression("OD"["600nm"]), x = expression("Time"["hrs"]), colour="Strain", linetype="Replicate")+
geom_vline(xintercept = 8, colour = "red", linetype = "dashed")
g1
#wrapped por cepa
g2<-ggplot(data = t, aes(x = hr, y = `OD real`, colour = as.factor(temp), linetype = as.factor(rep)))+
geom_line()+
facet_wrap(~Cepa)+
scale_x_continuous(limits = c(0,18))+
labs( title = "Growth by strain",y=expression("OD"["600nm"]), x = expression("Time"["hrs"]), colour="T(°C)", linetype="Replicate")+
geom_vline(xintercept = 8, colour = "red", linetype = "dashed")+
scale_color_manual(
values = c("30"="#63B8FF", "37"="lightsalmon", "42"="indianred3"))  # change colors here
g2
#one plot distinguishing between temps
g3<-ggplot(data = t, aes(x = hr, y = `OD real`, colour = as.factor(temp),  group = interaction(Cepa,temp,rep)))+
geom_line()+
scale_x_continuous(limits = c(0,18))+
labs( title = "Growth by temperature",y=expression("OD"["600nm"]), x = expression("Time"["hrs"]), colour="T(°C)")+
geom_vline(xintercept = 8, colour = "red", linetype = "dashed")+
scale_color_manual(
values = c("30"="#63B8FF", "37"="lightsalmon", "42"="indianred3"))  # change colors here
g3
ggsave(g1,
filename="C:/Users/natal/Documents/LIIGH/results/results_comsint_4c/individual_growth_curve.png" ,
bg="white",  width = 30, height = 14, units = "cm")
ggsave(g2,
filename="C:/Users/natal/Documents/LIIGH/results/results_comsint_4c/individual_growth_curve_bystrain.png" ,
bg="white",  width = 30, height = 14, units = "cm")
ggsave(g3,
filename="C:/Users/natal/Documents/LIIGH/results/results_comsint_4c/individual_growth_curve_bytemp.png" ,
bg="white",  width = 30, height = 14, units = "cm")
#Test for normality with shapiro wilk
shapiro.test(t$`OD real`)
#if normal, paired t-test?
x<-t%>%
filter(Cepa=="CH450"& temp==30 & between(hr, 0, 34))
y<-t%>%
filter(Cepa=="CH450"& temp==37)
t.test(x$`OD real`,y$`OD real`,paired = TRUE, alternative = "two.sided")
